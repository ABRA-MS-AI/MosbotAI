import{r as e,bW as tt,bM as st,bH as a,bY as at}from"./vendor-Db6cl1CV.js";import{R as se,G as nt,V as ot,u as b,L as it,U as rt,S as ct,Q as ut,a as lt,E as pt,A as mt,b as l,c as St,d as dt,e as gt,r as ht,T as kt,f as wt,g as ft,h as _t}from"./index-EDs62pof.js";import{b as xt,g as Ct,D as Tt}from"./fluentui-react-o9KU43ak.js";import"./fluentui-icons-c05NdEdY.js";const bt="_askContainer_1rw8c_1",yt="_askTopSection_1rw8c_8",Rt="_askBottomSection_1rw8c_15",At="_askTitle_1rw8c_25",Ot="_askQuestionInput_1rw8c_31",Pt="_askAnswerContainer_1rw8c_37",vt="_askAnalysisPanel_1rw8c_44",jt="_commandsContainer_1rw8c_61",Bt="_commandButton_1rw8c_68",n={askContainer:bt,askTopSection:yt,askBottomSection:Rt,askTitle:At,askQuestionInput:Ot,askAnswerContainer:Pt,askAnalysisPanel:vt,commandsContainer:jt,commandButton:Bt};function Et(){const[y,p]=e.useState(!1),[m,ae]=e.useState(""),[S,ne]=e.useState(""),[d,oe]=e.useState(""),[R,ie]=e.useState(.3),[g,re]=e.useState(null),[A,ce]=e.useState(0),[O,ue]=e.useState(0),[P,v]=e.useState(se.Hybrid),[j,B]=e.useState(3),[E,le]=e.useState(10),[I,pe]=e.useState("interleaved"),[U,Q]=e.useState(!0),[V,me]=e.useState(!1),[L,F]=e.useState(!1),[N,G]=e.useState(""),[h,Se]=e.useState(!1),[M,de]=e.useState(nt.TextAndImages),[k,ge]=e.useState(""),[w,he]=e.useState(""),[ke,we]=e.useState(""),[q,fe]=e.useState(ot.TextAndImageEmbeddings),[D,_e]=e.useState(!1),[H,xe]=e.useState(!1),[Ce,Te]=e.useState(!1),[be,ye]=e.useState(!1),[Re,Ae]=e.useState(!1),[Oe,Pe]=e.useState(!1),[ve,je]=e.useState(!1),[Be,Ee]=e.useState(!1),[Ie,Ue]=e.useState(!1),[Qe,Ve]=e.useState(!1),[Le,Fe]=e.useState(!1),[Ne,Ge]=e.useState(!1),Me=e.useRef(new Audio).current,[qe,De]=e.useState(!1),[He,ze]=e.useState(!1),[z,W]=e.useState(!1),f=e.useRef(""),[_,Y]=e.useState(!1),[c,J]=e.useState(),[i,We]=e.useState(),[Ye,K]=e.useState([]),Je={speechUrls:Ye,setSpeechUrls:K,audio:Me,isPlaying:qe,setIsPlaying:De},[X,Z]=e.useState(),[u,r]=e.useState(void 0),$=b?tt().instance:void 0,{loggedIn:ee}=e.useContext(it),Ke=async()=>{wt().then(t=>{Te(t.showGPT4VOptions),Q(t.showSemanticRankerOption),ye(t.showSemanticRankerOption),F(t.showQueryRewritingOption),Ae(t.showQueryRewritingOption),Pe(t.showReasoningEffortOption),t.showReasoningEffortOption&&G(t.defaultReasoningEffort),je(t.showVectorOption),t.showVectorOption||v(se.Text),Ee(t.showUserUpload),Ue(t.showLanguagePicker),Ve(t.showSpeechInput),Fe(t.showSpeechOutputBrowser),Ge(t.showSpeechOutputAzure),ze(t.showAgenticRetrievalOption),W(t.showAgenticRetrievalOption),t.showAgenticRetrievalOption&&B(10)})};e.useEffect(()=>{Ke()},[]);const x=async t=>{f.current=t,c&&J(void 0),Y(!0),Z(void 0),r(void 0);const s=$?await ft($):void 0;try{const T={messages:[{content:t,role:"user"}],context:{overrides:{prompt_template:m.length===0?void 0:m,prompt_template_prefix:S.length===0?void 0:S,prompt_template_suffix:d.length===0?void 0:d,include_category:k.length===0?void 0:k,exclude_category:w.length===0?void 0:w,top:j,max_subqueries:E,results_merge_strategy:I,temperature:R,minimum_reranker_score:A,minimum_search_score:O,retrieval_mode:P,semantic_ranker:U,semantic_captions:V,query_rewriting:L,reasoning_effort:N,use_oid_security_filter:D,use_groups_security_filter:H,vector_fields:q,use_gpt4v:h,gpt4v_input:M,language:te.language,use_agentic_retrieval:z,...g!==null?{seed:g}:{}}},session_state:i?i.session_state:null},et=await _t(T,s);We(et),K([null])}catch(T){J(T)}finally{Y(!1)}},Xe=(t,s)=>{switch(t){case"promptTemplate":ae(s);break;case"promptTemplatePrefix":ne(s);break;case"promptTemplateSuffix":oe(s);break;case"temperature":ie(s);break;case"seed":re(s);break;case"minimumRerankerScore":ce(s);break;case"minimumSearchScore":ue(s);break;case"retrieveCount":B(s);break;case"maxSubqueryCount":le(s);break;case"resultsMergeStrategy":pe(s);break;case"useSemanticRanker":Q(s);break;case"useSemanticCaptions":me(s);break;case"useQueryRewriting":F(s);break;case"reasoningEffort":G(s);break;case"excludeCategory":he(s);break;case"includeCategory":ge(s);break;case"useOidSecurityFilter":_e(s);break;case"useGroupsSecurityFilter":xe(s);break;case"useGPT4V":Se(s);break;case"gpt4vInput":de(s);break;case"vectorFields":fe(s);break;case"retrievalMode":v(s);break;case"useAgenticRetrieval":W(s)}},Ze=t=>{x(t),we(t)},$e=t=>{X===t&&u===l.CitationTab?r(void 0):(Z(t),r(l.CitationTab))},C=t=>{r(u===t?void 0:t)},{t:o,i18n:te}=st();return a.jsxs("div",{className:n.askContainer,children:[a.jsx(at,{children:a.jsx("title",{children:o("pageTitle")})}),a.jsxs("div",{className:n.askTopSection,children:[a.jsxs("div",{className:n.commandsContainer,children:[Be&&a.jsx(rt,{className:n.commandButton,disabled:!ee}),a.jsx(ct,{className:n.commandButton,onClick:()=>p(!y)})]}),a.jsx("h1",{className:n.askTitle,children:o("askTitle")}),a.jsx("div",{className:n.askQuestionInput,children:a.jsx(ut,{placeholder:o("gpt4vExamples.placeholder"),disabled:_,initQuestion:ke,onSend:t=>x(t),showSpeechInput:Qe})})]}),a.jsxs("div",{className:n.askBottomSection,children:[_&&a.jsx(xt,{label:o("generatingAnswer")}),!f.current&&a.jsxs("div",{className:n.askTopSection,children:[Ie&&a.jsx(lt,{onLanguageChange:t=>te.changeLanguage(t)}),a.jsx(pt,{onExampleClicked:Ze,useGPT4V:h})]}),!_&&i&&!c&&a.jsx("div",{className:n.askAnswerContainer,children:a.jsx(mt,{answer:i,index:0,speechConfig:Je,isStreaming:!1,onCitationClicked:t=>$e(t),onThoughtProcessClicked:()=>C(l.ThoughtProcessTab),onSupportingContentClicked:()=>C(l.SupportingContentTab),showSpeechOutputAzure:Ne,showSpeechOutputBrowser:Le})}),c?a.jsx("div",{className:n.askAnswerContainer,children:a.jsx(St,{error:c.toString(),onRetry:()=>x(f.current)})}):null,u&&i&&a.jsx(dt,{className:n.askAnalysisPanel,activeCitation:X,onActiveTabChanged:t=>C(t),citationHeight:"600px",answer:i,activeTab:u})]}),a.jsxs(Ct,{headerText:o("labels.headerText"),isOpen:y,isBlocking:!1,onDismiss:()=>p(!1),closeButtonAriaLabel:o("labels.closeButton"),onRenderFooterContent:()=>a.jsx(Tt,{onClick:()=>p(!1),children:o("labels.closeButton")}),isFooterAtBottom:!0,children:[a.jsx(gt,{promptTemplate:m,promptTemplatePrefix:S,promptTemplateSuffix:d,temperature:R,retrieveCount:j,maxSubqueryCount:E,resultsMergeStrategy:I,seed:g,minimumSearchScore:O,minimumRerankerScore:A,useSemanticRanker:U,useSemanticCaptions:V,useQueryRewriting:L,reasoningEffort:N,excludeCategory:w,includeCategory:k,retrievalMode:P,useGPT4V:h,gpt4vInput:M,vectorFields:q,showSemanticRankerOption:be,showQueryRewritingOption:Re,showReasoningEffortOption:Oe,showGPT4VOptions:Ce,showVectorOption:ve,useOidSecurityFilter:D,useGroupsSecurityFilter:H,useLogin:!!b,loggedIn:ee,requireAccessControl:ht,showAgenticRetrievalOption:He,useAgenticRetrieval:z,onChange:Xe}),b&&a.jsx(kt,{})]})]})}Et.displayName="Ask";export{Et as Component};
//# sourceMappingURL=Ask-CJUppDck.js.map
